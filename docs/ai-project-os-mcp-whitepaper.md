# AI Project OS × MCP 白皮书

## 1. 为什么 Prompt 工程失败

### 1.1 AI 会“顺从而非守法”

传统的 Prompt 工程试图通过自然语言指令来约束 AI 行为，但这种方式存在根本缺陷：AI 会尝试理解并执行指令，但它不会像人类一样遵守法律或规则体系。

当 AI 接收到一个复杂的任务时，它会：
- 尝试理解任务的核心需求
- 生成它认为最符合用户意图的结果
- 但它不会主动检查自己的行为是否违反了预设的工程规则

### 1.2 项目失控的根因不是模型，而是没有工程边界

AI 项目失控的根本原因不是 AI 模型不够智能，而是缺乏明确的工程边界和约束机制：

| 问题 | 传统 Prompt 工程 | AI Project OS |
|------|------------------|---------------|
| 阶段跳级 | ❌ 无法有效防止 | ✅ 严格的阶段冻结机制 |
| 代码失控 | ❌ 无法有效控制 | ✅ S5 阶段代码生成限制 |
| 架构破坏 | ❌ 无法有效拦截 | ✅ 架构约束和熔断机制 |
| 缺乏审计 | ❌ 无法有效追溯 | ✅ 强制的 S5 审计 |
| AI 越权 | ❌ 无法有效阻止 | ✅ MCP 硬拒绝机制 |

## 2. 什么是 AI Project OS

### 2.1 AI ≠ 决策者

AI Project OS 挑战了传统 AI 开发的核心假设：AI 不应该是项目的决策者，而应该是被授权的执行系统。

在 AI Project OS 中：
- 人类负责定义目标、制定规则和做出关键决策
- AI 只负责执行已被授权的任务
- 系统确保 AI 只能在预设的边界内行动

### 2.2 AI = 被授权的执行系统

AI Project OS 将 AI 定义为一个被授权的执行系统，它具有以下特征：

1. **有限的权限**：AI 只能执行特定阶段的特定任务
2. **明确的边界**：AI 不能超越预设的工程规则
3. **可审计的行为**：AI 的所有行为都必须留下审计痕迹
4. **受控的生成**：AI 生成的代码必须符合严格的质量标准

## 3. MCP 是什么（通俗版）

### 3.1 MCP = AI 的“工程宪法”

MCP（Model Context Protocol）是 AI Project OS 的核心协议，它定义了 AI 在项目开发中的行为规则和约束机制。可以将其视为 AI 的“工程宪法”。

### 3.2 state / freeze / guard / audit = 四大支柱

MCP 建立在四大核心支柱之上：

1. **State（状态）**：
   - 项目的唯一真实状态来源是 `state.json`
   - AI 必须始终基于当前状态行动
   - 状态变更必须通过明确的冻结机制

2. **Freeze（冻结）**：
   - 每个阶段必须显式冻结后才能进入下一阶段
   - 冻结是决策，生成只是执行
   - 禁止跳级和回滚

3. **Guard（守护）**：
   - 代码生成必须经过守护检查
   - S5 之前禁止生成代码
   - 锁定后禁止修改代码

4. **Audit（审计）**：
   - 每个 S5 任务必须提交审计记录
   - 没有审计就没有交付
   - 审计记录必须包含完整的上下文和断言

## 4. 5S × MCP 的独特性

### 4.1 市面 MCP：偏工具

市面上现有的 MCP 解决方案大多偏向于工具层面，它们提供了一些基本的约束机制，但缺乏完整的工程治理体系：

- 它们可能提供了状态管理，但缺乏严格的阶段冻结机制
- 它们可能提供了代码检查，但缺乏完整的审计体系
- 它们可能提供了工具集成，但缺乏统一的规则引擎

### 4.2 你这套 MCP：偏工程治理

AI Project OS 的 MCP 解决方案与众不同，它更侧重于工程治理，而不仅仅是工具集成：

1. **完整的 5S 工作流**：
   - S1：Scope 定义
   - S2：Spec 固化
   - S3：架构冻结
   - S4：任务分解
   - S5：实现 + 审计

2. **严格的阶段约束**：
   - 每个阶段有明确的目标和约束
   - 阶段之间有严格的转换规则
   - 禁止跳级和回滚

3. **S5 稳定性规则**：
   - Context Refresh：显式加载上下文
   - Change Fuse：架构不足立即熔断
   - Pseudo-TDD：先定义什么叫“对”

4. **统一的规则引擎**：
   - 所有规则都由一个统一的规则引擎执行
   - 规则违反时的硬拒绝机制
   - 详细的违反原因记录

## 5. 为什么「不懂代码的人」反而最受益

### 5.1 不需要判断代码好坏

在 AI Project OS 中，不懂代码的人不需要判断 AI 生成的代码质量：

- 系统会确保 AI 只在 S5 阶段生成代码
- 系统会确保 AI 生成的代码符合架构约束
- 系统会确保 AI 为每个任务提交完整的审计记录

### 5.2 只需要判断：是否越权

不懂代码的人只需要做一个简单的判断：AI 是否越权？

- AI 是否在正确的阶段行动？
- AI 是否遵守了冻结规则？
- AI 是否提交了必要的审计记录？

这个判断不需要任何技术知识，只需要理解项目的基本流程和目标。

## 6. 商业与未来

### 6.1 团队版

AI Project OS 团队版将提供以下新增能力：

- **多人 state.json（带签名）**：支持多个团队成员共同管理项目状态，每个变更都带有签名
- **冻结需要多方确认**：重要阶段的冻结需要多个团队成员确认
- **Audit 需要 reviewer**：每个 S5 审计记录需要经过 reviewer 确认
- **团队协作仪表盘**：实时展示项目状态和团队成员活动

### 6.2 企业版

AI Project OS 企业版将提供以下企业级功能：

- **审计留痕**：完整的审计链，支持合规要求
- **合规**：符合各种行业合规标准
- **内部 MCP Registry**：企业内部的 MCP 工具和规则注册表
- **禁止 Prompt 漏洞**：防止通过 Prompt 绕过 MCP 规则
- **企业级集成**：与企业现有系统的深度集成

### 6.3 AI 工程审计

AI Project OS 还将提供独立的 AI 工程审计服务：

- **项目审计**：对现有 AI 项目进行审计，识别潜在风险
- **合规检查**：检查项目是否符合企业合规要求
- **最佳实践评估**：评估项目是否遵循 AI 工程最佳实践
- **改进建议**：提供具体的改进建议和实施方案

## 7. 技术架构

### 7.1 MCP SDK

AI Project OS MCP SDK 是一个 Python 库，提供了完整的 MCP 实现：

```
ai_project_os_mcp/
├─ core/               # 核心模块
│  ├─ state_manager.py     # state.json 权威读写
│  ├─ rule_engine.py       # 5S + S5 稳定性规则
│  └─ violation.py         # Hard Refusal
├─ tools/              # MCP 工具集
│  ├─ get_stage.py
│  ├─ freeze_stage.py
│  ├─ guard_src.py
│  └─ submit_audit.py
├─ adapters/           # Agent 适配器
│  ├─ claude.py
│  ├─ cursor.py
│  └─ trae.py
└─ server.py           # MCP Server
```

### 7.2 Agent 集成

AI Project OS MCP 支持与多种 AI Agent 集成：

1. **Claude**：通过 System Prompt 和工具调用集成
2. **Cursor**：作为编辑器插件集成
3. **Trae**：作为多 Agent 系统的统一协议
4. **本地 Agent**：通过 SDK 直接集成

### 7.3 可扩展架构

AI Project OS MCP 采用可扩展架构，支持：

- 自定义规则
- 自定义工具
- 自定义 Agent 适配器
- 自定义审计模板

## 8. 结论

AI Project OS × MCP 代表了下一代 AI 软件工程的方向：将 AI 自动编程约束进真实软件工程流程，确保 AI 只在当前冻结阶段行动，所有工程决策必须显式冻结，所有代码变更必须可审计、可追责。

这种方法将使 AI 从一个不可控的助手，转变为一个可靠的、被授权的执行系统，从而让任何人都能放心地使用 AI 完成真实项目。

---

**AI Project OS**

*让任何人都能放心地用 AI 做项目*

*State > Prompt | Freeze > Generate | Audit > Output*
